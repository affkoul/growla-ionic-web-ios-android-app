{"version":3,"sources":["./src/addons/notes/pages/list/list.html","./src/addons/notes/notes-lazy.module.ts","./src/addons/notes/pages/list/list.page.ts"],"names":[],"mappings":"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","file":"addons-notes-notes-lazy-module.js","sourcesContent":["export default \"<ion-header>\\n    <ion-toolbar>\\n        <ion-buttons slot=\\\"start\\\">\\n            <ion-back-button [text]=\\\"'core.back' | translate\\\"></ion-back-button>\\n        </ion-buttons>\\n\\n        <h1>{{ 'addon.notes.notes' | translate }}</h1>\\n        <ion-buttons slot=\\\"end\\\">\\n        </ion-buttons>\\n    </ion-toolbar>\\n</ion-header>\\n<core-navbar-buttons slot=\\\"end\\\">\\n    <ion-button [hidden]=\\\"!canDeleteNotes\\\" slot=\\\"end\\\" fill=\\\"clear\\\" (click)=\\\"toggleDelete()\\\"\\n        [attr.aria-label]=\\\"'core.toggledelete' | translate\\\">\\n        <ion-icon name=\\\"fas-pen\\\" slot=\\\"icon-only\\\" aria-hidden=\\\"true\\\"></ion-icon>\\n    </ion-button>\\n    <core-context-menu>\\n        <core-context-menu-item [hidden]=\\\"!(notesLoaded && !hasOffline)\\\" [priority]=\\\"100\\\"\\n            [content]=\\\"'core.refresh' | translate\\\" (action)=\\\"refreshNotes(false)\\\"\\n            [iconAction]=\\\"refreshIcon\\\" [closeOnClick]=\\\"true\\\">\\n        </core-context-menu-item>\\n        <core-context-menu-item [hidden]=\\\"!(notesLoaded && hasOffline)\\\" [priority]=\\\"100\\\"\\n            [content]=\\\"'core.settings.synchronizenow' | translate\\\" (action)=\\\"refreshNotes(true)\\\"\\n            [iconAction]=\\\"syncIcon\\\" [closeOnClick]=\\\"false\\\"></core-context-menu-item>\\n    </core-context-menu>\\n</core-navbar-buttons>\\n<ion-content>\\n    <ion-refresher slot=\\\"fixed\\\" [disabled]=\\\"!notesLoaded\\\" (ionRefresh)=\\\"refreshNotes(false, $event.target)\\\">\\n        <ion-refresher-content pullingText=\\\"{{ 'core.pulltorefresh' | translate }}\\\"></ion-refresher-content>\\n    </ion-refresher>\\n\\n    <core-loading [hideUntil]=\\\"notesLoaded\\\">\\n        <ion-item class=\\\"ion-text-wrap\\\" *ngIf=\\\"user\\\">\\n            <core-user-avatar [user]=\\\"user\\\" [courseId]=\\\"courseId\\\" slot=\\\"start\\\" [linkProfile]=\\\"false\\\"></core-user-avatar>\\n            <ion-label><h2>{{user!.fullname}}</h2></ion-label>\\n        </ion-item>\\n\\n        <core-combobox [selection]=\\\"type\\\" (onChange)=\\\"typeChanged($event)\\\">\\n            <ion-select-option class=\\\"ion-text-wrap\\\" value=\\\"site\\\">\\n                {{ 'addon.notes.sitenotes' | translate }}\\n            </ion-select-option>\\n            <ion-select-option class=\\\"ion-text-wrap\\\" value=\\\"course\\\">\\n                {{ 'addon.notes.coursenotes' | translate }}\\n            </ion-select-option>\\n            <ion-select-option class=\\\"ion-text-wrap\\\" value=\\\"personal\\\">\\n                {{ 'addon.notes.personalnotes' | translate }}\\n            </ion-select-option>\\n        </core-combobox>\\n\\n        <ion-card class=\\\"core-warning-card\\\" *ngIf=\\\"hasOffline\\\">\\n            <ion-item>\\n                <ion-icon name=\\\"fas-exclamation-triangle\\\" slot=\\\"start\\\" aria-hidden=\\\"true\\\"></ion-icon>\\n                <ion-label>\\n                    {{ 'core.thereisdatatosync' | translate:{$a: 'addon.notes.notes' | translate | lowercase } }}\\n                </ion-label>\\n            </ion-item>\\n        </ion-card>\\n\\n        <core-empty-box *ngIf=\\\"notes && notes.length == 0\\\" icon=\\\"fas-receipt\\\" [message]=\\\"'addon.notes.nonotes' | translate\\\">\\n        </core-empty-box>\\n\\n        <ng-container *ngIf=\\\"notes && notes.length > 0\\\">\\n            <ion-card *ngFor=\\\"let note of notes\\\">\\n                <ion-item class=\\\"ion-text-wrap\\\">\\n                    <core-user-avatar [user]=\\\"note\\\" [courseId]=\\\"courseId\\\" slot=\\\"start\\\" *ngIf=\\\"!userId\\\"></core-user-avatar>\\n                    <ion-label>\\n                        <p class=\\\"item-heading\\\" *ngIf=\\\"!userId\\\">{{note.userfullname}}</p>\\n                        <p *ngIf=\\\"!note.deleted && !note.offline\\\" slot=\\\"end\\\">\\n                            <span class=\\\"ion-text-wrap\\\">{{note.lastmodified | coreDateDayOrTime}}</span>\\n                        </p>\\n                    </ion-label>\\n                    <p *ngIf=\\\"note.offline\\\" slot=\\\"end\\\">\\n                        <ion-icon name=\\\"fas-clock\\\" aria-hidden=\\\"true\\\"></ion-icon> <span class=\\\"ion-text-wrap\\\">\\n                            {{ 'core.notsent' | translate }}\\n                        </span>\\n                    </p>\\n                    <p *ngIf=\\\"note.deleted\\\" slot=\\\"end\\\">\\n                        <ion-icon name=\\\"fas-trash\\\" aria-hidden=\\\"true\\\"></ion-icon> <span class=\\\"ion-text-wrap\\\">\\n                            {{ 'core.deletedoffline' | translate }}\\n                        </span>\\n                    </p>\\n                    <ion-button *ngIf=\\\"note.deleted\\\" slot=\\\"end\\\" fill=\\\"clear\\\" color=\\\"danger\\\" (click)=\\\"undoDeleteNote($event, note)\\\"\\n                        [attr.aria-label]=\\\"'core.restore' | translate\\\">\\n                        <ion-icon name=\\\"fas-undo-alt\\\" slot=\\\"icon-only\\\" aria-hidden=\\\"true\\\"></ion-icon>\\n                    </ion-button>\\n                    <ion-button *ngIf=\\\"showDelete && !note.deleted && (type != 'personal' || note.usermodified == currentUserId)\\\"\\n                        slot=\\\"end\\\" fill=\\\"clear\\\" [@coreSlideInOut]=\\\"'fromRight'\\\" color=\\\"danger\\\" (click)=\\\"deleteNote($event, note)\\\"\\n                        [attr.aria-label]=\\\"'core.delete' | translate\\\">\\n                        <ion-icon name=\\\"fas-trash\\\" slot=\\\"icon-only\\\" aria-hidden=\\\"true\\\"></ion-icon>\\n                    </ion-button>\\n                </ion-item>\\n                <ion-item class=\\\"ion-text-wrap\\\">\\n                    <ion-label><core-format-text [text]=\\\"note.content\\\" [filter]=\\\"false\\\"></core-format-text></ion-label>\\n                </ion-item>\\n            </ion-card>\\n        </ng-container>\\n    </core-loading>\\n\\n    <ion-fab slot=\\\"fixed\\\" core-fab vertical=\\\"bottom\\\" horizontal=\\\"end\\\" *ngIf=\\\"userId && notesLoaded\\\">\\n        <ion-fab-button (click)=\\\"addNote($event)\\\" [attr.aria-label]=\\\"'addon.notes.addnewnote' |translate\\\">\\n            <ion-icon name=\\\"fas-plus\\\" aria-hidden=\\\"true\\\"></ion-icon>\\n            <span class=\\\"sr-only\\\">{{ 'addon.notes.addnewnote' | translate }}</span>\\n        </ion-fab-button>\\n    </ion-fab>\\n</ion-content>\\n\";","// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { CoreSharedModule } from '@/core/shared.module';\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { CoreCommentsComponentsModule } from '@features/comments/components/components.module';\nimport { CoreTagComponentsModule } from '@features/tag/components/components.module';\nimport { AddonNotesListPage } from './pages/list/list.page';\n\nconst routes: Routes = [\n    {\n        path: '',\n        component: AddonNotesListPage,\n    },\n];\n\n@NgModule({\n    imports: [\n        RouterModule.forChild(routes),\n        CoreSharedModule,\n        CoreCommentsComponentsModule,\n        CoreTagComponentsModule,\n    ],\n    exports: [RouterModule],\n    declarations: [\n        AddonNotesListPage,\n    ],\n})\nexport class AddonNotesLazyModule {}\n","// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { CoreConstants } from '@/core/constants';\nimport { AddonNotesAddComponent, AddonNotesAddModalReturn } from '@addons/notes/components/add/add-modal';\nimport { AddonNotes, AddonNotesNoteFormatted, AddonNotesPublishState } from '@addons/notes/services/notes';\nimport { AddonNotesOffline } from '@addons/notes/services/notes-offline';\nimport { AddonNotesSync, AddonNotesSyncProvider } from '@addons/notes/services/notes-sync';\nimport { Component, OnDestroy, OnInit, ViewChild } from '@angular/core';\nimport { CoreAnimations } from '@components/animations';\nimport { CoreUser, CoreUserProfile } from '@features/user/services/user';\nimport { IonContent, IonRefresher } from '@ionic/angular';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreSites } from '@services/sites';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreTextUtils } from '@services/utils/text';\nimport { CoreUtils } from '@services/utils/utils';\nimport { CoreEventObserver, CoreEvents } from '@singletons/events';\n\n/**\n * Page that displays a list of notes.\n */\n@Component({\n    selector: 'page-addon-notes-list-page',\n    templateUrl: 'list.html',\n    animations: [CoreAnimations.SLIDE_IN_OUT],\n})\nexport class AddonNotesListPage implements OnInit, OnDestroy {\n\n     @ViewChild(IonContent) content?: IonContent;\n\n    courseId: number;\n    userId?: number;\n    type: AddonNotesPublishState = 'course';\n    refreshIcon = CoreConstants.ICON_LOADING;\n    syncIcon = CoreConstants.ICON_LOADING;\n    notes: AddonNotesNoteFormatted[] = [];\n    hasOffline = false;\n    notesLoaded = false;\n    user?: CoreUserProfile;\n    showDelete = false;\n    canDeleteNotes = false;\n    currentUserId: number;\n\n    protected syncObserver: CoreEventObserver;\n\n    constructor() {\n        this.courseId = CoreNavigator.getRouteNumberParam('courseId')!;\n        this.userId = CoreNavigator.getRouteNumberParam('userId');\n\n        // Refresh data if notes are synchronized automatically.\n        this.syncObserver = CoreEvents.on(AddonNotesSyncProvider.AUTO_SYNCED, (data) => {\n            if (data.courseId == this.courseId) {\n                // Show the sync warnings.\n                this.showSyncWarnings(data.warnings);\n\n                // Refresh the data.\n                this.notesLoaded = false;\n                this.refreshIcon = CoreConstants.ICON_LOADING;\n                this.syncIcon = CoreConstants.ICON_LOADING;\n\n                this.content?.scrollToTop();\n                this.fetchNotes(false);\n            }\n        }, CoreSites.getCurrentSiteId());\n\n        this.currentUserId = CoreSites.getCurrentSiteUserId();\n    }\n\n    /**\n     * Component being initialized.\n     */\n    async ngOnInit(): Promise<void> {\n        await this.fetchNotes(true);\n\n        CoreUtils.ignoreErrors(AddonNotes.logView(this.courseId, this.userId));\n    }\n\n    /**\n     * Fetch notes.\n     *\n     * @param sync When to resync notes.\n     * @param showErrors When to display errors or not.\n     * @return Promise with the notes.\n     */\n    protected async fetchNotes(sync = false, showErrors = false): Promise<void> {\n        if (sync) {\n            await this.syncNotes(showErrors);\n        }\n\n        try {\n            const allNotes = await AddonNotes.getNotes(this.courseId, this.userId);\n\n            const notesList: AddonNotesNoteFormatted[] = allNotes[this.type + 'notes'] || [];\n\n            notesList.forEach((note) => {\n                note.content = CoreTextUtils.decodeHTML(note.content);\n            });\n\n            await AddonNotes.setOfflineDeletedNotes(notesList, this.courseId);\n\n            this.hasOffline = notesList.some((note) => note.offline || note.deleted);\n\n            if (this.userId) {\n                this.notes = notesList;\n\n                // Get the user profile to retrieve the user image.\n                this.user = await CoreUser.getProfile(this.userId, this.courseId, true);\n            } else {\n                this.notes = await AddonNotes.getNotesUserData(notesList);\n            }\n        } catch (error) {\n            CoreDomUtils.showErrorModal(error);\n        } finally {\n            let canDelete = this.notes && this.notes.length > 0;\n            if (canDelete && this.type == 'personal') {\n                canDelete = !!this.notes.find((note) => note.usermodified == this.currentUserId);\n            }\n            this.canDeleteNotes = canDelete;\n\n            this.notesLoaded = true;\n            this.refreshIcon = CoreConstants.ICON_REFRESH;\n            this.syncIcon = CoreConstants.ICON_SYNC;\n        }\n    }\n\n    /**\n     * Refresh notes on PTR.\n     *\n     * @param showErrors Whether to display errors or not.\n     * @param refresher Refresher instance.\n     */\n    refreshNotes(showErrors: boolean, refresher?: IonRefresher): void {\n        this.refreshIcon = CoreConstants.ICON_LOADING;\n        this.syncIcon = CoreConstants.ICON_LOADING;\n\n        AddonNotes.invalidateNotes(this.courseId, this.userId).finally(() => {\n            this.fetchNotes(true, showErrors).finally(() => {\n                if (refresher) {\n                    refresher?.complete();\n                }\n            });\n        });\n    }\n\n    /**\n     * Function called when the type has changed.\n     *\n     * @param type New type.\n     */\n    async typeChanged(type: AddonNotesPublishState): Promise<void> {\n        this.type = type;\n        this.notesLoaded = false;\n        this.refreshIcon = CoreConstants.ICON_LOADING;\n        this.syncIcon = CoreConstants.ICON_LOADING;\n\n        await this.fetchNotes(true);\n        CoreUtils.ignoreErrors(AddonNotes.logView(this.courseId, this.userId));\n    }\n\n    /**\n     * Add a new Note to user and course.\n     *\n     * @param e Event.\n     */\n    async addNote(e: Event): Promise<void> {\n        e.preventDefault();\n        e.stopPropagation();\n\n        const modalData = await CoreDomUtils.openModal<AddonNotesAddModalReturn>({\n            component: AddonNotesAddComponent,\n            componentProps: {\n                userId: this.userId,\n                courseId: this.courseId,\n                type: this.type,\n            },\n        });\n\n        if (typeof modalData != 'undefined') {\n\n            if (modalData.sent && modalData.type) {\n                if (modalData.type != this.type) {\n                    this.type = modalData.type;\n                    this.notesLoaded = false;\n                }\n\n                this.refreshNotes(false);\n            } else if (modalData.type && modalData.type != this.type) {\n                this.typeChanged(modalData.type);\n            }\n        }\n    }\n\n    /**\n     * Delete a note.\n     *\n     * @param e Click event.\n     * @param note Note to delete.\n     */\n    async deleteNote(e: Event, note: AddonNotesNoteFormatted): Promise<void> {\n        e.preventDefault();\n        e.stopPropagation();\n\n        try {\n            await CoreDomUtils.showDeleteConfirm('addon.notes.deleteconfirm');\n            try {\n                await AddonNotes.deleteNote(note, this.courseId);\n                this.showDelete = false;\n\n                this.refreshNotes(false);\n\n                CoreDomUtils.showToast('addon.notes.eventnotedeleted', true, 3000);\n\n            } catch (error) {\n                CoreDomUtils.showErrorModalDefault(error, 'Delete note failed.');\n            }\n        } catch {\n            // User cancelled, nothing to do.\n        }\n    }\n\n    /**\n     * Restore a note.\n     *\n     * @param e Click event.\n     * @param note Note to delete.\n     */\n    async undoDeleteNote(e: Event, note: AddonNotesNoteFormatted): Promise<void> {\n        e.preventDefault();\n        e.stopPropagation();\n\n        await AddonNotesOffline.undoDeleteNote(note.id);\n        this.refreshNotes(true);\n    }\n\n    /**\n     * Toggle delete.\n     */\n    toggleDelete(): void {\n        this.showDelete = !this.showDelete;\n    }\n\n    /**\n     * Tries to synchronize course notes.\n     *\n     * @param showErrors Whether to display errors or not.\n     * @return Promise resolved when done.\n     */\n    protected async syncNotes(showErrors: boolean): Promise<void> {\n        try {\n            const result = await AddonNotesSync.syncNotes(this.courseId);\n\n            this.showSyncWarnings(result.warnings);\n        } catch (error) {\n            if (showErrors) {\n                CoreDomUtils.showErrorModalDefault(error, 'core.errorsync', true);\n            }\n        }\n    }\n\n    /**\n     * Show sync warnings if any.\n     *\n     * @param warnings the warnings\n     */\n    protected showSyncWarnings(warnings: string[]): void {\n        const message = CoreTextUtils.buildMessage(warnings);\n\n        if (message) {\n            CoreDomUtils.showErrorModal(message);\n        }\n    }\n\n    /**\n     * Page destroyed.\n     */\n    ngOnDestroy(): void {\n        this.syncObserver && this.syncObserver.off();\n    }\n\n}\n"],"sourceRoot":"webpack:///"}