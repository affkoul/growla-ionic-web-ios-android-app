{"version":3,"sources":["./src/core/features/course/pages/list-mod-type/list-mod-type.html","./src/core/features/course/pages/list-mod-type/list-mod-type.module.ts","./src/core/features/course/pages/list-mod-type/list-mod-type.page.ts"],"names":[],"mappings":"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","file":"pages-list-mod-type-list-mod-type-module.js","sourcesContent":["export default \"<ion-header>\\n    <ion-toolbar>\\n        <ion-buttons slot=\\\"start\\\">\\n            <ion-back-button [text]=\\\"'core.back' | translate\\\"></ion-back-button>\\n        </ion-buttons>\\n        <h1>{{ title }}</h1>\\n    </ion-toolbar>\\n</ion-header>\\n<ion-content>\\n    <ion-refresher slot=\\\"fixed\\\" [disabled]=\\\"!loaded\\\" (ionRefresh)=\\\"refreshData($event.target)\\\">\\n        <ion-refresher-content pullingText=\\\"{{ 'core.pulltorefresh' | translate }}\\\"></ion-refresher-content>\\n    </ion-refresher>\\n    <core-loading [hideUntil]=\\\"loaded\\\">\\n        <core-empty-box *ngIf=\\\"!sections || !sections.length\\\" icon=\\\"fas-box-open\\\"\\n            [message]=\\\"'core.course.nocontentavailable' | translate\\\">\\n        </core-empty-box>\\n\\n        <ion-list>\\n            <ng-container *ngFor=\\\"let section of sections\\\" >\\n                <ng-container *ngFor=\\\"let module of section.modules\\\">\\n                    <core-course-module *ngIf=\\\"module.visibleoncoursepage !== 0\\\" [module]=\\\"module\\\" [section]=\\\"section\\\"\\n                        [courseId]=\\\"courseId\\\" [downloadEnabled]=\\\"downloadEnabled\\\">\\n                    </core-course-module>\\n                </ng-container>\\n            </ng-container>\\n        </ion-list>\\n    </core-loading>\\n</ion-content>\\n\";","// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\n\nimport { CoreSharedModule } from '@/core/shared.module';\nimport { CoreCourseListModTypePage } from './list-mod-type.page';\nimport { CoreCourseComponentsModule } from '@features/course/components/components.module';\n\nconst routes: Routes = [\n    {\n        path: '',\n        component: CoreCourseListModTypePage,\n    },\n];\n\n@NgModule({\n    declarations: [\n        CoreCourseListModTypePage,\n    ],\n    imports: [\n        RouterModule.forChild(routes),\n        CoreSharedModule,\n        CoreCourseComponentsModule,\n    ],\n    exports: [RouterModule],\n})\nexport class CoreCourseListModTypePageModule {}\n","// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnInit } from '@angular/core';\n\nimport { CoreSites } from '@services/sites';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreCourse } from '@features/course/services/course';\nimport { CoreCourseModuleDelegate } from '@features/course/services/module-delegate';\nimport { CoreCourseHelper, CoreCourseSection } from '@features/course/services/course-helper';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreConstants } from '@/core/constants';\nimport { IonRefresher } from '@ionic/angular';\nimport { CoreUtils } from '@services/utils/utils';\n\n/**\n * Page that displays all modules of a certain type in a course.\n */\n@Component({\n    selector: 'page-core-course-list-mod-type',\n    templateUrl: 'list-mod-type.html',\n})\nexport class CoreCourseListModTypePage implements OnInit {\n\n    sections: CoreCourseSection[] = [];\n    title = '';\n    loaded = false;\n    downloadEnabled = false;\n    courseId?: number;\n\n    protected modName?: string;\n    protected archetypes: Record<string, number> = {}; // To speed up the check of modules.\n\n    /**\n     * @inheritdoc\n     */\n    async ngOnInit(): Promise<void> {\n        this.title = CoreNavigator.getRouteParam('title') || '';\n        this.courseId = CoreNavigator.getRouteNumberParam('courseId');\n        this.modName = CoreNavigator.getRouteParam('modName');\n        this.downloadEnabled = !CoreSites.getCurrentSite()?.isOfflineDisabled();\n\n        try {\n            await this.fetchData();\n        } finally {\n            this.loaded = true;\n        }\n    }\n\n    /**\n     * Fetches the data.\n     *\n     * @return Resolved when done.\n     */\n    protected async fetchData(): Promise<void> {\n        if (!this.courseId) {\n            return;\n        }\n\n        try {\n            // Get all the modules in the course.\n            let sections = await CoreCourse.getSections(this.courseId, false, true);\n\n            sections = sections.filter((section) => {\n                if (!section.modules) {\n                    return false;\n                }\n\n                section.modules = section.modules.filter((mod) => {\n                    if (mod.uservisible === false || !CoreCourse.moduleHasView(mod)) {\n                        // Ignore this module.\n                        return false;\n                    }\n\n                    if (this.modName === 'resources') {\n                        // Check that the module is a resource.\n                        if (typeof this.archetypes[mod.modname] == 'undefined') {\n                            this.archetypes[mod.modname] = CoreCourseModuleDelegate.supportsFeature<number>(\n                                mod.modname,\n                                CoreConstants.FEATURE_MOD_ARCHETYPE,\n                                CoreConstants.MOD_ARCHETYPE_OTHER,\n                            );\n                        }\n\n                        if (this.archetypes[mod.modname] == CoreConstants.MOD_ARCHETYPE_RESOURCE) {\n                            return true;\n                        }\n\n                    } else if (mod.modname == this.modName) {\n                        return true;\n                    }\n                });\n\n                return section.modules.length > 0;\n            });\n\n            const result = CoreCourseHelper.addHandlerDataForModules(sections, this.courseId);\n\n            this.sections = result.sections;\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'Error getting data');\n        }\n    }\n\n    /**\n     * Refresh the data.\n     *\n     * @param refresher Refresher.\n     * @return Promise resolved when done.\n     */\n    async refreshData(refresher: IonRefresher): Promise<void> {\n        await CoreUtils.ignoreErrors(CoreCourse.invalidateSections(this.courseId || 0));\n\n        try {\n            await this.fetchData();\n        } finally {\n            refresher.complete();\n        }\n    }\n\n}\n"],"sourceRoot":"webpack:///"}