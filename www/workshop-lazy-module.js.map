{"version":3,"sources":["./src/addons/mod/workshop/pages/assessment/assessment.html","./src/addons/mod/workshop/pages/edit-submission/edit-submission.html","./src/addons/mod/workshop/pages/index/index.html","./src/addons/mod/workshop/pages/assessment/assessment.ts","./src/addons/mod/workshop/pages/edit-submission/edit-submission.ts","./src/addons/mod/workshop/pages/index/index.ts","./src/addons/mod/workshop/workshop-lazy.module.ts"],"names":[],"mappings":"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","file":"workshop-lazy-module.js","sourcesContent":["export default \"<ion-header>\\n    <ion-toolbar>\\n        <ion-buttons slot=\\\"start\\\">\\n            <ion-back-button [text]=\\\"'core.back' | translate\\\"></ion-back-button>\\n        </ion-buttons>\\n        <h1>\\n            <core-format-text [text]=\\\"title\\\" contextLevel=\\\"module\\\" [contextInstanceId]=\\\"workshop && workshop.coursemodule\\\"\\n                [courseId]=\\\"courseId\\\">\\n            </core-format-text>\\n        </h1>\\n        <ion-buttons slot=\\\"end\\\" [hidden]=\\\"!evaluating\\\">\\n            <ion-button fill=\\\"clear\\\" (click)=\\\"saveEvaluation()\\\">\\n                {{ 'core.save' | translate }}\\n            </ion-button>\\n        </ion-buttons>\\n    </ion-toolbar>\\n</ion-header>\\n<ion-content>\\n    <ion-refresher slot=\\\"fixed\\\" [disabled]=\\\"!loaded\\\" (ionRefresh)=\\\"refreshAssessment($event.target)\\\" *ngIf=\\\"!evaluating\\\">\\n        <ion-refresher-content pullingText=\\\"{{ 'core.pulltorefresh' | translate }}\\\"></ion-refresher-content>\\n    </ion-refresher>\\n    <core-loading [hideUntil]=\\\"loaded\\\">\\n\\n        <ion-item class=\\\"ion-text-wrap\\\">\\n            <core-user-avatar *ngIf=\\\"profile\\\" [user]=\\\"profile\\\" slot=\\\"start\\\" [courseId]=\\\"courseId\\\" [userId]=\\\"profile.id\\\">\\n            </core-user-avatar>\\n\\n            <ion-label>\\n                <h2 *ngIf=\\\"profile && profile.fullname\\\">{{profile.fullname}}</h2>\\n\\n                <p *ngIf=\\\"workshop && assessment && showGrade(assessment.grade)\\\">\\n                    {{ 'addon.mod_workshop.submissiongradeof' | translate:{$a: workshop.grade } }}: {{assessment.grade}}\\n                </p>\\n                <p *ngIf=\\\"workshop && access && access.canviewallsubmissions && assessment && showGrade(assessment.gradinggrade)\\\"\\n                    [class.core-has-overriden-grade]=\\\" showGrade(assessment.gradinggrade)\\\">\\n                    {{ 'addon.mod_workshop.gradinggradeof' | translate:{$a: workshop.gradinggrade } }}: {{assessment.gradinggrade}}\\n                </p>\\n                <p *ngIf=\\\"access && access.canviewallsubmissions && assessment && showGrade(assessment.gradinggradeover)\\\"\\n                    class=\\\"core-overriden-grade\\\">\\n                    {{ 'addon.mod_workshop.gradinggradeover' | translate }}: {{assessment.gradinggradeover}}\\n                </p>\\n                <p *ngIf=\\\"assessment && assessment.weight && assessment.weight != 1\\\">\\n                    {{ 'addon.mod_workshop.weightinfo' | translate:{$a: assessment.weight } }}\\n                </p>\\n                <ion-badge *ngIf=\\\"!assessment || !showGrade(assessment.grade)\\\" color=\\\"danger\\\">\\n                    {{ 'addon.mod_workshop.notassessed' | translate }}\\n                </ion-badge>\\n            </ion-label>\\n        </ion-item>\\n\\n        <addon-mod-workshop-assessment-strategy\\n            *ngIf=\\\"assessment && assessmentId && showGrade(assessment.grade) && workshop && access\\\" [workshop]=\\\"workshop\\\"\\n            [access]=\\\"access\\\" [assessmentId]=\\\"assessmentId\\\" [userId]=\\\"profile && profile.id\\\" [strategy]=\\\"strategy\\\">\\n        </addon-mod-workshop-assessment-strategy>\\n\\n        <form [formGroup]=\\\"evaluateForm\\\" *ngIf=\\\"evaluating\\\" #evaluateFormEl>\\n            <ion-item class=\\\"ion-text-wrap\\\">\\n                <ion-label><h2>{{ 'addon.mod_workshop.assessmentsettings' | translate }}</h2></ion-label>\\n            </ion-item>\\n            <ion-item class=\\\"ion-text-wrap\\\" *ngIf=\\\"access?.canallocate\\\">\\n                <ion-label position=\\\"stacked\\\">\\n                    <span core-mark-required=\\\"true\\\">\\n                        {{ 'addon.mod_workshop.assessmentweight' | translate }}\\n                    </span>\\n                </ion-label>\\n                <ion-select formControlName=\\\"weight\\\" required=\\\"true\\\" interface=\\\"action-sheet\\\"\\n                    [interfaceOptions]=\\\"{header: 'addon.mod_workshop.assessmentweight' | translate}\\\">\\n                    <ion-select-option *ngFor=\\\"let w of weights\\\" [value]=\\\"w\\\">{{ w }}</ion-select-option>\\n                </ion-select>\\n            </ion-item>\\n            <ion-item class=\\\"ion-text-wrap\\\">\\n                <ion-label>\\n                    <h2>{{ 'addon.mod_workshop.gradinggradecalculated' | translate }}</h2>\\n                    <p>{{ gradingGrade }}</p>\\n                </ion-label>\\n            </ion-item>\\n            <ion-item class=\\\"ion-text-wrap\\\" *ngIf=\\\"access?.canoverridegrades\\\">\\n                <ion-label position=\\\"stacked\\\">{{ 'addon.mod_workshop.gradinggradeover' | translate }}</ion-label>\\n                <ion-select formControlName=\\\"grade\\\" interface=\\\"action-sheet\\\"\\n                    [interfaceOptions]=\\\"{header: 'addon.mod_workshop.gradinggradeover' | translate}\\\">\\n                    <ion-select-option *ngFor=\\\"let grade of evaluationGrades\\\" [value]=\\\"grade.value\\\">\\n                        {{grade.label}}\\n                    </ion-select-option>\\n                </ion-select>\\n            </ion-item>\\n            <ion-item *ngIf=\\\"access?.canoverridegrades\\\">\\n                <ion-label position=\\\"stacked\\\">{{ 'addon.mod_workshop.feedbackreviewer' | translate }}</ion-label>\\n                <core-rich-text-editor [control]=\\\"evaluateForm.controls['text']\\\" name=\\\"text\\\"\\n                    [autoSave]=\\\"true\\\" contextLevel=\\\"module\\\" [contextInstanceId]=\\\"workshop?.coursemodule\\\"\\n                    elementId=\\\"feedbackreviewer_editor\\\" [draftExtraParams]=\\\"{asid: assessmentId}\\\">\\n                </core-rich-text-editor>\\n            </ion-item>\\n        </form>\\n        <ion-list *ngIf=\\\"!evaluating && evaluate && evaluate.text\\\">\\n            <ion-item class=\\\"ion-text-wrap\\\">\\n                <core-user-avatar *ngIf=\\\"evaluateByProfile\\\" [user]=\\\"evaluateByProfile\\\" slot=\\\"start\\\"\\n                    [courseId]=\\\"courseId\\\" [userId]=\\\"evaluateByProfile.id\\\"></core-user-avatar>\\n                <ion-label>\\n                    <h2 *ngIf=\\\"evaluateByProfile && evaluateByProfile.fullname\\\">\\n                        {{ 'addon.mod_workshop.feedbackby' | translate : {$a: evaluateByProfile.fullname} }}\\n                    </h2>\\n                    <core-format-text [text]=\\\"evaluate.text\\\" contextLevel=\\\"module\\\" [contextInstanceId]=\\\"workshop?.coursemodule\\\"\\n                        [courseId]=\\\"courseId\\\">\\n                    </core-format-text>\\n                </ion-label>\\n            </ion-item>\\n        </ion-list>\\n    </core-loading>\\n</ion-content>\\n\";","export default \"<ion-header>\\n    <ion-toolbar>\\n        <ion-buttons slot=\\\"start\\\">\\n            <ion-back-button [text]=\\\"'core.back' | translate\\\"></ion-back-button>\\n        </ion-buttons>\\n        <h1>{{ 'addon.mod_workshop.editsubmission' | translate }}</h1>\\n        <ion-buttons slot=\\\"end\\\">\\n            <ion-button fill=\\\"clear\\\" (click)=\\\"save()\\\" [attr.aria-label]=\\\"'core.save' | translate\\\">\\n                {{ 'core.save' | translate }}\\n            </ion-button>\\n        </ion-buttons>\\n    </ion-toolbar>\\n</ion-header>\\n<ion-content>\\n    <core-loading [hideUntil]=\\\"loaded\\\">\\n        <form [formGroup]=\\\"editForm\\\" *ngIf=\\\"workshop\\\" #editFormEl>\\n            <ion-item class=\\\"ion-text-wrap\\\">\\n                <ion-label position=\\\"stacked\\\">\\n                    <span core-mark-required=\\\"true\\\">\\n                        {{ 'addon.mod_workshop.submissiontitle' | translate }}\\n                    </span>\\n                </ion-label>\\n                <ion-input name=\\\"title\\\" type=\\\"text\\\" [placeholder]=\\\"'addon.mod_workshop.submissiontitle' | translate\\\"\\n                    formControlName=\\\"title\\\">\\n                </ion-input>\\n            </ion-item>\\n\\n            <ion-item *ngIf=\\\"textAvailable\\\">\\n                <ion-label position=\\\"stacked\\\">\\n                    <span [core-mark-required]=\\\"textRequired\\\">\\n                        {{ 'addon.mod_workshop.submissioncontent' | translate }}\\n                    </span>\\n                </ion-label>\\n                <core-rich-text-editor [control]=\\\"editForm.controls['content']\\\" name=\\\"content\\\"\\n                    [placeholder]=\\\"'addon.mod_workshop.submissioncontent' | translate\\\" name=\\\"content\\\" [component]=\\\"component\\\"\\n                    [componentId]=\\\"componentId\\\" [autoSave]=\\\"true\\\" contextLevel=\\\"module\\\" [contextInstanceId]=\\\"module.id\\\"\\n                    elementId=\\\"content_editor\\\" [draftExtraParams]=\\\"editorExtraParams\\\"></core-rich-text-editor>\\n            </ion-item>\\n\\n            <core-attachments *ngIf=\\\"fileAvailable\\\" [files]=\\\"attachments\\\" [maxSize]=\\\"workshop.maxbytes\\\"\\n                [maxSubmissions]=\\\"workshop.nattachments\\\" [component]=\\\"component\\\" [componentId]=\\\"workshop.coursemodule\\\"\\n                allowOffline=\\\"true\\\" [acceptedTypes]=\\\"workshop.submissionfiletypes\\\" [required]=\\\"fileRequired\\\">\\n            </core-attachments>\\n        </form>\\n    </core-loading>\\n</ion-content>\\n\";","export default \"<ion-header>\\n    <ion-toolbar>\\n        <ion-buttons slot=\\\"start\\\">\\n            <ion-back-button [text]=\\\"'core.back' | translate\\\"></ion-back-button>\\n        </ion-buttons>\\n        <h1>\\n            <core-format-text [text]=\\\"title\\\" contextLevel=\\\"module\\\" [contextInstanceId]=\\\"module.id\\\" [courseId]=\\\"courseId\\\">\\n            </core-format-text>\\n        </h1>\\n        <ion-buttons slot=\\\"end\\\">\\n            <!-- The buttons defined by the component will be added in here. -->\\n        </ion-buttons>\\n    </ion-toolbar>\\n</ion-header>\\n<ion-content>\\n    <ion-refresher slot=\\\"fixed\\\" [disabled]=\\\"!activityComponent?.loaded\\\" (ionRefresh)=\\\"activityComponent?.doRefresh($event.target)\\\">\\n        <ion-refresher-content pullingText=\\\"{{ 'core.pulltorefresh' | translate }}\\\"></ion-refresher-content>\\n    </ion-refresher>\\n\\n    <addon-mod-workshop-index [module]=\\\"module\\\" [courseId]=\\\"courseId\\\" [group]=\\\"selectedGroup\\\" (dataRetrieved)=\\\"updateData($event)\\\">\\n    </addon-mod-workshop-index>\\n</ion-content>\\n\";","// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnInit, OnDestroy, ViewChild, ElementRef } from '@angular/core';\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { CoreCourse } from '@features/course/services/course';\nimport { CoreGradesHelper, CoreGradesMenuItem } from '@features/grades/services/grades-helper';\nimport { CoreUser, CoreUserProfile } from '@features/user/services/user';\nimport { CanLeave } from '@guards/can-leave';\nimport { IonRefresher } from '@ionic/angular';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreSites } from '@services/sites';\nimport { CoreSync } from '@services/sync';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreTextUtils } from '@services/utils/text';\nimport { Translate } from '@singletons';\nimport { CoreEventObserver, CoreEvents } from '@singletons/events';\nimport { CoreForms } from '@singletons/form';\nimport {\n    AddonModWorkshop,\n    AddonModWorkshopAssessmentSavedChangedEventData,\n    AddonModWorkshopData,\n    AddonModWorkshopGetWorkshopAccessInformationWSResponse,\n    AddonModWorkshopPhase,\n    AddonModWorkshopProvider,\n    AddonModWorkshopSubmissionData,\n} from '../../services/workshop';\nimport { AddonModWorkshopHelper, AddonModWorkshopSubmissionAssessmentWithFormData } from '../../services/workshop-helper';\nimport { AddonModWorkshopOffline } from '../../services/workshop-offline';\nimport { AddonModWorkshopSyncProvider } from '../../services/workshop-sync';\n\n/**\n * Page that displays a workshop assessment.\n */\n@Component({\n    selector: 'page-addon-mod-workshop-assessment-page',\n    templateUrl: 'assessment.html',\n})\nexport class AddonModWorkshopAssessmentPage implements OnInit, OnDestroy, CanLeave {\n\n    @ViewChild('evaluateFormEl') formElement!: ElementRef;\n\n    assessment!: AddonModWorkshopSubmissionAssessmentWithFormData;\n    submission!: AddonModWorkshopSubmissionData;\n    profile!: CoreUserProfile;\n    courseId!: number;\n    access?: AddonModWorkshopGetWorkshopAccessInformationWSResponse;\n    assessmentId!: number;\n    evaluating = false;\n    loaded = false;\n    showGrade: (grade?: string | number) => boolean;\n    evaluateForm: FormGroup;\n    maxGrade?: number;\n    workshop?: AddonModWorkshopData;\n    strategy?: string;\n    title = '';\n    evaluate: AddonModWorkshopAssessmentEvaluation = {\n        text: '',\n        grade: -1,\n        weight: 1,\n    };\n\n    weights: number[] = [];\n    evaluateByProfile?: CoreUserProfile;\n    evaluationGrades: CoreGradesMenuItem[] = [];\n    gradingGrade?: string | number;\n\n    protected workshopId!: number;\n    protected originalEvaluation: AddonModWorkshopAssessmentEvaluation = {\n        text: '',\n        grade: -1,\n        weight: 1,\n    };\n\n    protected hasOffline = false;\n    protected syncObserver: CoreEventObserver;\n    protected isDestroyed = false;\n    protected siteId: string;\n    protected currentUserId: number;\n    protected forceLeave = false;\n\n    constructor(\n        protected fb: FormBuilder,\n    ) {\n        this.siteId = CoreSites.getCurrentSiteId();\n        this.currentUserId = CoreSites.getCurrentSiteUserId();\n\n        this.showGrade = AddonModWorkshopHelper.showGrade;\n\n        this.evaluateForm = new FormGroup({});\n        this.evaluateForm.addControl('weight', this.fb.control('', Validators.required));\n        this.evaluateForm.addControl('grade', this.fb.control(''));\n        this.evaluateForm.addControl('text', this.fb.control(''));\n\n        // Refresh workshop on sync.\n        this.syncObserver = CoreEvents.on(AddonModWorkshopSyncProvider.AUTO_SYNCED, (data) => {\n            // Update just when all database is synced.\n            if (this.workshopId === data.workshopId) {\n                this.loaded = false;\n                this.refreshAllData();\n            }\n        }, this.siteId);\n    }\n\n    /**\n     * Component being initialized.\n     */\n    ngOnInit(): void {\n        this.assessment = CoreNavigator.getRouteParam<AddonModWorkshopSubmissionAssessmentWithFormData>('assessment')!;\n        this.submission = CoreNavigator.getRouteParam<AddonModWorkshopSubmissionData>('submission')!;\n        this.profile = CoreNavigator.getRouteParam<CoreUserProfile>('profile')!;\n        this.courseId = CoreNavigator.getRouteNumberParam('courseId')!;\n\n        this.assessmentId = this.assessment.id;\n        this.workshopId = this.submission.workshopid;\n\n        this.fetchAssessmentData();\n    }\n\n    /**\n     * Check if we can leave the page or not.\n     *\n     * @return Resolved if we can leave it, rejected if not.\n     */\n    async canLeave(): Promise<boolean> {\n        if (this.forceLeave || !this.evaluating) {\n            return true;\n        }\n\n        if (!this.hasEvaluationChanged()) {\n            return true;\n        }\n\n        // Show confirmation if some data has been modified.\n        await CoreDomUtils.showConfirm(Translate.instant('core.confirmcanceledit'));\n\n        CoreForms.triggerFormCancelledEvent(this.formElement, this.siteId);\n\n        return true;\n    }\n\n    /**\n     * Fetch the assessment data.\n     *\n     * @return Resolved when done.\n     */\n    protected async fetchAssessmentData(): Promise<void> {\n        try {\n            this.workshop = await AddonModWorkshop.getWorkshopById(this.courseId, this.workshopId);\n            this.title = this.workshop.name;\n            this.strategy = this.workshop.strategy;\n\n            const gradeInfo = await CoreCourse.getModuleBasicGradeInfo(this.workshop.coursemodule);\n            this.maxGrade = gradeInfo?.grade;\n\n            this.access = await AddonModWorkshop.getWorkshopAccessInformation(\n                this.workshopId,\n                { cmId: this.workshop.coursemodule },\n            );\n\n            // Load Weights selector.\n            if (this.assessmentId && (this.access.canallocate || this.access.canoverridegrades)) {\n                if (!this.isDestroyed) {\n                    // Block the workshop.\n                    CoreSync.blockOperation(AddonModWorkshopProvider.COMPONENT, this.workshopId);\n                }\n\n                this.evaluating = true;\n            } else {\n                this.evaluating = false;\n            }\n\n            if (!this.evaluating && this.workshop.phase != AddonModWorkshopPhase.PHASE_CLOSED) {\n                return;\n            }\n\n            // Get all info of the assessment.\n            const assessment = await AddonModWorkshopHelper.getReviewerAssessmentById(this.workshopId, this.assessmentId, {\n                userId: this.profile && this.profile.id,\n                cmId: this.workshop.coursemodule,\n            });\n\n            this.assessment = AddonModWorkshopHelper.realGradeValue(this.workshop, assessment);\n            this.evaluate.text = this.assessment.feedbackreviewer || '';\n            this.evaluate.weight = this.assessment.weight;\n            this.gradingGrade = this.assessment.gradinggrade ?? '-';\n\n            if (this.evaluating) {\n                if (this.access.canallocate) {\n                    this.weights = [];\n                    for (let i = 16; i >= 0; i--) {\n                        this.weights[i] = i;\n                    }\n                }\n\n                if (this.access.canoverridegrades) {\n                    const defaultGrade = Translate.instant('addon.mod_workshop.notoverridden');\n                    this.evaluationGrades =\n                        await CoreGradesHelper.makeGradesMenu(this.workshop.gradinggrade, undefined, defaultGrade, -1);\n                }\n\n                try {\n                    const offlineAssess = await AddonModWorkshopOffline.getEvaluateAssessment(this.workshopId, this.assessmentId);\n                    this.hasOffline = true;\n                    this.evaluate.weight = offlineAssess.weight;\n                    if (this.access.canoverridegrades) {\n                        this.evaluate.text = offlineAssess.feedbacktext || '';\n                        this.evaluate.grade = parseInt(offlineAssess.gradinggradeover, 10) || -1;\n                    }\n                } catch {\n                    this.hasOffline = false;\n                    // No offline, load online.\n                    if (this.access.canoverridegrades) {\n                        this.evaluate.text = this.assessment.feedbackreviewer || '';\n                        this.evaluate.grade = parseInt(String(this.assessment.gradinggradeover), 10) || -1;\n                    }\n                } finally {\n                    this.originalEvaluation.weight = this.evaluate.weight;\n                    if (this.access.canoverridegrades) {\n                        this.originalEvaluation.text = this.evaluate.text;\n                        this.originalEvaluation.grade = this.evaluate.grade;\n                    }\n\n                    this.evaluateForm.controls['weight'].setValue(this.evaluate.weight);\n                    if (this.access.canoverridegrades) {\n                        this.evaluateForm.controls['grade'].setValue(this.evaluate.grade);\n                        this.evaluateForm.controls['text'].setValue(this.evaluate.text);\n                    }\n                }\n\n            } else if (this.workshop.phase == AddonModWorkshopPhase.PHASE_CLOSED && this.assessment.gradinggradeoverby) {\n                this.evaluateByProfile = await CoreUser.getProfile(this.assessment.gradinggradeoverby, this.courseId, true);\n            }\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'mm.course.errorgetmodule', true);\n        } finally {\n            this.loaded = true;\n        }\n    }\n\n    /**\n     * Force leaving the page, without checking for changes.\n     */\n    protected forceLeavePage(): void {\n        this.forceLeave = true;\n        CoreNavigator.back();\n    }\n\n    /**\n     * Check if data has changed.\n     *\n     * @return True if changed, false otherwise.\n     */\n    protected hasEvaluationChanged(): boolean {\n        if (!this.loaded || !this.evaluating) {\n            return false;\n        }\n\n        const inputData = this.evaluateForm.value;\n\n        if (this.originalEvaluation.weight != inputData.weight) {\n            return true;\n        }\n\n        if (this.access && this.access.canoverridegrades) {\n            if (this.originalEvaluation.text != inputData.text) {\n                return true;\n            }\n\n            if (this.originalEvaluation.grade != inputData.grade) {\n                return true;\n            }\n        }\n\n        return false;\n    }\n\n    /**\n     * Convenience function to refresh all the data.\n     *\n     * @return Resolved when done.\n     */\n    protected async refreshAllData(): Promise<void> {\n        const promises: Promise<void>[] = [];\n\n        promises.push(AddonModWorkshop.invalidateWorkshopData(this.courseId));\n        promises.push(AddonModWorkshop.invalidateWorkshopAccessInformationData(this.workshopId));\n        promises.push(AddonModWorkshop.invalidateReviewerAssesmentsData(this.workshopId));\n\n        if (this.assessmentId) {\n            promises.push(AddonModWorkshop.invalidateAssessmentFormData(this.workshopId, this.assessmentId));\n            promises.push(AddonModWorkshop.invalidateAssessmentData(this.workshopId, this.assessmentId));\n        }\n\n        try {\n            await Promise.all(promises);\n        } finally {\n            CoreEvents.trigger(AddonModWorkshopProvider.ASSESSMENT_INVALIDATED, null, this.siteId);\n\n            await this.fetchAssessmentData();\n        }\n    }\n\n    /**\n     * Pull to refresh.\n     *\n     * @param refresher Refresher.\n     */\n    refreshAssessment(refresher: IonRefresher): void {\n        if (this.loaded) {\n            this.refreshAllData().finally(() => {\n                refresher?.complete();\n            });\n        }\n    }\n\n    /**\n     * Save the assessment evaluation.\n     */\n    async saveEvaluation(): Promise<void> {\n        // Check if data has changed.\n        if (this.hasEvaluationChanged()) {\n            await this.sendEvaluation();\n        }\n\n        // Go back.\n        this.forceLeavePage();\n    }\n\n    /**\n     * Sends the evaluation to be saved on the server.\n     *\n     * @return Resolved when done.\n     */\n    protected async sendEvaluation(): Promise<void> {\n        const modal = await CoreDomUtils.showModalLoading('core.sending', true);\n        const inputData: AddonModWorkshopAssessmentEvaluation = this.evaluateForm.value;\n\n        const grade = inputData.grade >= 0 ? String(inputData.grade) : '';\n        // Add some HTML to the message if needed.\n        const text = CoreTextUtils.formatHtmlLines(inputData.text);\n\n        try {\n            // Try to send it to server.\n            const result = await AddonModWorkshop.evaluateAssessment(\n                this.workshopId,\n                this.assessmentId,\n                this.courseId,\n                text,\n                inputData.weight,\n                grade,\n            );\n\n            CoreForms.triggerFormSubmittedEvent(this.formElement, !!result, this.siteId);\n\n            const data: AddonModWorkshopAssessmentSavedChangedEventData = {\n                workshopId: this.workshopId,\n                assessmentId: this.assessmentId,\n                userId: this.currentUserId,\n            };\n\n            return AddonModWorkshop.invalidateAssessmentData(this.workshopId, this.assessmentId).finally(() => {\n                CoreEvents.trigger(AddonModWorkshopProvider.ASSESSMENT_SAVED, data, this.siteId);\n            });\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'Cannot save assessment evaluation');\n        } finally {\n            modal.dismiss();\n        }\n    }\n\n    /**\n     * Component being destroyed.\n     */\n    ngOnDestroy(): void {\n        this.isDestroyed = true;\n\n        this.syncObserver?.off();\n        // Restore original back functions.\n        CoreSync.unblockOperation(AddonModWorkshopProvider.COMPONENT, this.workshopId);\n    }\n\n}\n\ntype AddonModWorkshopAssessmentEvaluation = {\n    text: string;\n    grade: number;\n    weight: number;\n};\n","// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnInit, OnDestroy, ViewChild, ElementRef } from '@angular/core';\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { CoreError } from '@classes/errors/error';\nimport { CoreCourseModule } from '@features/course/services/course-helper';\nimport { CoreFileUploader, CoreFileUploaderStoreFilesResult } from '@features/fileuploader/services/fileuploader';\nimport { CanLeave } from '@guards/can-leave';\nimport { CoreFile } from '@services/file';\nimport { CoreFileEntry, CoreFileHelper } from '@services/file-helper';\nimport { CoreNavigator } from '@services/navigator';\nimport { CoreSites } from '@services/sites';\nimport { CoreSync } from '@services/sync';\nimport { CoreDomUtils } from '@services/utils/dom';\nimport { CoreTextUtils } from '@services/utils/text';\nimport { Translate } from '@singletons';\nimport { CoreEvents } from '@singletons/events';\nimport { CoreForms } from '@singletons/form';\nimport {\n    AddonModWorkshopProvider,\n    AddonModWorkshop,\n    AddonModWorkshopSubmissionType,\n    AddonModWorkshopSubmissionChangedEventData,\n    AddonModWorkshopAction,\n    AddonModWorkshopGetWorkshopAccessInformationWSResponse,\n    AddonModWorkshopData,\n} from '../../services/workshop';\nimport { AddonModWorkshopHelper, AddonModWorkshopSubmissionDataWithOfflineData } from '../../services/workshop-helper';\nimport { AddonModWorkshopOffline } from '../../services/workshop-offline';\n\n/**\n * Page that displays the workshop edit submission.\n */\n@Component({\n    selector: 'page-addon-mod-workshop-edit-submission',\n    templateUrl: 'edit-submission.html',\n})\nexport class AddonModWorkshopEditSubmissionPage implements OnInit, OnDestroy, CanLeave {\n\n    @ViewChild('editFormEl') formElement!: ElementRef;\n\n    module!: CoreCourseModule;\n    courseId!: number;\n    access!: AddonModWorkshopGetWorkshopAccessInformationWSResponse;\n    submission?: AddonModWorkshopSubmissionDataWithOfflineData;\n\n    loaded = false;\n    component = AddonModWorkshopProvider.COMPONENT;\n    componentId!: number;\n    editForm: FormGroup; // The form group.\n    editorExtraParams: Record<string, unknown> = {}; // Extra params to identify the draft.\n    workshop?: AddonModWorkshopData;\n    textAvailable = false;\n    textRequired = false;\n    fileAvailable = false;\n    fileRequired = false;\n    attachments: CoreFileEntry[] = [];\n\n    protected workshopId!: number;\n    protected submissionId = 0;\n    protected userId: number;\n    protected originalData: AddonModWorkshopEditSubmissionInputData = {\n        title: '',\n        content: '',\n        attachmentfiles: [],\n    };\n\n    protected hasOffline = false;\n    protected editing = false;\n    protected forceLeave = false;\n    protected siteId: string;\n    protected isDestroyed = false;\n\n    constructor(\n        protected fb: FormBuilder,\n    ) {\n\n        this.userId = CoreSites.getCurrentSiteUserId();\n        this.siteId = CoreSites.getCurrentSiteId();\n\n        this.editForm = new FormGroup({});\n        this.editForm.addControl('title', this.fb.control('', Validators.required));\n        this.editForm.addControl('content', this.fb.control(''));\n    }\n\n    /**\n     * Component being initialized.\n     */\n    ngOnInit(): void {\n        this.module = CoreNavigator.getRouteParam<CoreCourseModule>('module')!;\n        this.courseId = CoreNavigator.getRouteNumberParam('courseId')!;\n        this.access = CoreNavigator.getRouteParam<AddonModWorkshopGetWorkshopAccessInformationWSResponse>('access')!;\n        this.submissionId = CoreNavigator.getRouteNumberParam('submissionId') || 0;\n\n        if (this.submissionId > 0) {\n            this.editorExtraParams.id = this.submissionId;\n        }\n\n        this.workshopId = this.module.instance!;\n        this.componentId = this.module.id;\n\n        if (!this.isDestroyed) {\n            // Block the workshop.\n            CoreSync.blockOperation(this.component, this.workshopId);\n        }\n\n        this.fetchSubmissionData();\n    }\n\n    /**\n     * Check if we can leave the page or not.\n     *\n     * @return Resolved if we can leave it, rejected if not.\n     */\n    async canLeave(): Promise<boolean> {\n        if (this.forceLeave) {\n            return true;\n        }\n\n        // Check if data has changed.\n        if (this.hasDataChanged()) {\n            // Show confirmation if some data has been modified.\n            await CoreDomUtils.showConfirm(Translate.instant('core.confirmcanceledit'));\n        }\n\n        if (this.submission?.attachmentfiles) {\n            // Delete the local files from the tmp folder.\n            CoreFileUploader.clearTmpFiles(this.submission.attachmentfiles);\n        }\n\n        CoreForms.triggerFormCancelledEvent(this.formElement, this.siteId);\n\n        return true;\n    }\n\n    /**\n     * Fetch the submission data.\n     *\n     * @return Resolved when done.\n     */\n    protected async fetchSubmissionData(): Promise<void> {\n        try {\n            this.workshop = await AddonModWorkshop.getWorkshop(this.courseId, this.module.id);\n            this.textAvailable = (this.workshop.submissiontypetext != AddonModWorkshopSubmissionType.SUBMISSION_TYPE_DISABLED);\n            this.textRequired = (this.workshop.submissiontypetext == AddonModWorkshopSubmissionType.SUBMISSION_TYPE_REQUIRED);\n            this.fileAvailable = (this.workshop.submissiontypefile != AddonModWorkshopSubmissionType.SUBMISSION_TYPE_DISABLED);\n            this.fileRequired = (this.workshop.submissiontypefile == AddonModWorkshopSubmissionType.SUBMISSION_TYPE_REQUIRED);\n\n            this.editForm.controls.content.setValidators(this.textRequired ? Validators.required : null);\n\n            if (this.submissionId > 0) {\n                this.editing = true;\n\n                this.submission =\n                    await AddonModWorkshopHelper.getSubmissionById(this.workshopId, this.submissionId, { cmId: this.module.id });\n\n                const canEdit = this.userId == this.submission.authorid &&\n                    this.access.cansubmit &&\n                    this.access.modifyingsubmissionallowed;\n\n                if (!canEdit) {\n                    // Should not happen, but go back if does.\n                    this.forceLeavePage();\n\n                    return;\n                }\n            } else if (!this.access.cansubmit || !this.access.creatingsubmissionallowed) {\n                // Should not happen, but go back if does.\n                this.forceLeavePage();\n\n                return;\n            }\n\n            const submissionsActions = await AddonModWorkshopOffline.getSubmissions(this.workshopId);\n            if (submissionsActions && submissionsActions.length) {\n                this.hasOffline = true;\n                this.submission = await AddonModWorkshopHelper.applyOfflineData(this.submission, submissionsActions);\n            } else {\n                this.hasOffline = false;\n            }\n\n            if (this.submission) {\n                this.originalData.title = this.submission.title || '';\n                this.originalData.content = this.submission.content || '';\n                this.originalData.attachmentfiles = [];\n\n                (this.submission.attachmentfiles || []).forEach((file) => {\n                    let filename = CoreFile.getFileName(file);\n                    if (!filename) {\n                        // We don't have filename, extract it from the path.\n                        filename = CoreFileHelper.getFilenameFromPath(file) || '';\n                    }\n\n                    this.originalData.attachmentfiles.push({\n                        filename,\n                        fileurl: 'fileurl' in file ? file.fileurl : '',\n                    });\n                });\n\n                this.editForm.controls['title'].setValue(this.submission.title);\n                this.editForm.controls['content'].setValue(this.submission.content);\n                this.attachments = this.submission.attachmentfiles || [];\n            }\n\n            this.loaded = true;\n        } catch (error) {\n            this.loaded = false;\n\n            CoreDomUtils.showErrorModalDefault(error, 'core.course.errorgetmodule', true);\n\n            this.forceLeavePage();\n        }\n    }\n\n    /**\n     * Force leaving the page, without checking for changes.\n     */\n    protected forceLeavePage(): void {\n        this.forceLeave = true;\n        CoreNavigator.back();\n    }\n\n    /**\n     * Get the form input data.\n     *\n     * @return Object with all the info.\n     */\n    protected getInputData(): AddonModWorkshopEditSubmissionInputData {\n        const values: AddonModWorkshopEditSubmissionInputData = {\n            title: this.editForm.value.title,\n            content: '',\n            attachmentfiles: [],\n        };\n\n        if (this.textAvailable) {\n            values.content = this.editForm.value.content || '';\n        }\n\n        if (this.fileAvailable) {\n            values.attachmentfiles = this.attachments;\n        }\n\n        return values;\n    }\n\n    /**\n     * Check if data has changed.\n     *\n     * @return True if changed or false if not.\n     */\n    protected hasDataChanged(): boolean {\n        if (!this.loaded) {\n            return false;\n        }\n\n        const inputData = this.getInputData();\n        if (this.originalData.title != inputData.title || this.textAvailable && this.originalData.content != inputData.content) {\n            return true;\n        }\n\n        if (this.fileAvailable) {\n            return CoreFileUploader.areFileListDifferent(inputData.attachmentfiles, this.originalData.attachmentfiles);\n        }\n\n        return false;\n    }\n\n    /**\n     * Save the submission.\n     */\n    async save(): Promise<void> {\n        // Check if data has changed.\n        if (this.hasDataChanged()) {\n            try {\n                await this.saveSubmission();\n                // Go back to entry list.\n                this.forceLeavePage();\n            } catch{\n                // Nothing to do.\n            }\n        } else {\n            // Nothing to save, just go back.\n            this.forceLeavePage();\n        }\n    }\n\n    /**\n     * Send submission and save.\n     *\n     * @return Resolved when done.\n     */\n    protected async saveSubmission(): Promise<void> {\n        const inputData = this.getInputData();\n\n        if (!inputData.title) {\n            CoreDomUtils.showAlertTranslated('core.notice', 'addon.mod_workshop.submissionrequiredtitle');\n\n            throw new CoreError(Translate.instant('addon.mod_workshop.submissionrequiredtitle'));\n        }\n\n        const noText = CoreTextUtils.htmlIsBlank(inputData.content);\n        const noFiles = !inputData.attachmentfiles.length;\n\n        if ((this.textRequired && noText) || (this.fileRequired && noFiles) || (noText && noFiles)) {\n            CoreDomUtils.showAlertTranslated('core.notice', 'addon.mod_workshop.submissionrequiredcontent');\n\n            throw new CoreError(Translate.instant('addon.mod_workshop.submissionrequiredcontent'));\n        }\n\n        let saveOffline = false;\n\n        const modal = await CoreDomUtils.showModalLoading('core.sending', true);\n        const submissionId = this.submission?.id;\n\n        // Add some HTML to the message if needed.\n        if (this.textAvailable) {\n            inputData.content = CoreTextUtils.formatHtmlLines(inputData.content);\n        }\n\n        // Upload attachments first if any.\n        let allowOffline = !inputData.attachmentfiles.length;\n        try {\n            let attachmentsId: number | undefined;\n            let storeFilesResult: CoreFileUploaderStoreFilesResult | undefined;\n\n            try {\n                attachmentsId = await AddonModWorkshopHelper.uploadOrStoreSubmissionFiles(\n                    this.workshopId,\n                    inputData.attachmentfiles,\n                    false,\n                );\n            } catch {\n                // Cannot upload them in online, save them in offline.\n                saveOffline = true;\n                allowOffline = true;\n\n                storeFilesResult = await AddonModWorkshopHelper.uploadOrStoreSubmissionFiles(\n                    this.workshopId,\n                    inputData.attachmentfiles,\n                    true,\n                );\n            }\n\n            if (!saveOffline && !this.fileAvailable) {\n                attachmentsId = undefined;\n            }\n\n            let newSubmissionId: number | false;\n            if (this.editing) {\n                if (saveOffline) {\n                    // Save submission in offline.\n                    await AddonModWorkshopOffline.saveSubmission(\n                        this.workshopId,\n                        this.courseId,\n                        inputData.title,\n                        inputData.content,\n                        storeFilesResult,\n                        submissionId,\n                        AddonModWorkshopAction.UPDATE,\n                    );\n                    newSubmissionId = false;\n                } else {\n                    // Try to send it to server.\n                    // Don't allow offline if there are attachments since they were uploaded fine.\n                    newSubmissionId = await AddonModWorkshop.updateSubmission(\n                        this.workshopId,\n                        submissionId!,\n                        this.courseId,\n                        inputData.title,\n                        inputData.content,\n                        attachmentsId,\n                        undefined,\n                        allowOffline,\n                    );\n                }\n            } else {\n                if (saveOffline) {\n                    // Save submission in offline.\n                    await AddonModWorkshopOffline.saveSubmission(\n                        this.workshopId,\n                        this.courseId,\n                        inputData.title,\n                        inputData.content,\n                        storeFilesResult,\n                        undefined,\n                        AddonModWorkshopAction.ADD,\n                    );\n                    newSubmissionId = false;\n                } else {\n                    // Try to send it to server.\n                    // Don't allow offline if there are attachments since they were uploaded fine.\n                    newSubmissionId = await AddonModWorkshop.addSubmission(\n                        this.workshopId,\n                        this.courseId,\n                        inputData.title,\n                        inputData.content,\n                        attachmentsId,\n                        undefined,\n                        allowOffline,\n                    );\n                }\n            }\n\n            CoreForms.triggerFormSubmittedEvent(this.formElement, !!newSubmissionId, this.siteId);\n\n            const data: AddonModWorkshopSubmissionChangedEventData = {\n                workshopId: this.workshopId,\n            };\n\n            if (newSubmissionId) {\n                // Data sent to server, delete stored files (if any).\n                AddonModWorkshopOffline.deleteSubmissionAction(\n                    this.workshopId,\n                    this.editing ? AddonModWorkshopAction.UPDATE : AddonModWorkshopAction.ADD,\n                );\n\n                AddonModWorkshopHelper.deleteSubmissionStoredFiles(this.workshopId, this.siteId);\n                data.submissionId = newSubmissionId;\n            }\n\n            CoreEvents.trigger(CoreEvents.ACTIVITY_DATA_SENT, { module: 'workshop' });\n\n            const promise = newSubmissionId ? AddonModWorkshop.invalidateSubmissionData(this.workshopId, newSubmissionId) :\n                Promise.resolve();\n\n            await promise.finally(() => {\n                CoreEvents.trigger(AddonModWorkshopProvider.SUBMISSION_CHANGED, data, this.siteId);\n\n                // Delete the local files from the tmp folder.\n                CoreFileUploader.clearTmpFiles(inputData.attachmentfiles);\n            });\n        } catch (error) {\n            CoreDomUtils.showErrorModalDefault(error, 'Cannot save submission');\n        } finally {\n            modal.dismiss();\n        }\n    }\n\n    protected getFilesComponentId(): string {\n        const id = this.submissionId > 0\n            ? this.submissionId\n            : 'newsub';\n\n        return this.workshopId + '_' + id;\n    }\n\n    /**\n     * Component being destroyed.\n     */\n    ngOnDestroy(): void {\n        this.isDestroyed = true;\n        CoreSync.unblockOperation(this.component, this.workshopId);\n    }\n\n}\n\ntype AddonModWorkshopEditSubmissionInputData = {\n    title: string;\n    content: string;\n    attachmentfiles: CoreFileEntry[];\n};\n","// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnInit, ViewChild } from '@angular/core';\nimport { CoreCourseModuleMainActivityPage } from '@features/course/classes/main-activity-page';\nimport { CoreNavigator } from '@services/navigator';\nimport { AddonModWorkshopIndexComponent } from '../../components/index/index';\n\n/**\n * Page that displays a workshop.\n */\n@Component({\n    selector: 'page-addon-mod-workshop-index',\n    templateUrl: 'index.html',\n})\nexport class AddonModWorkshopIndexPage extends CoreCourseModuleMainActivityPage<AddonModWorkshopIndexComponent> implements OnInit {\n\n    @ViewChild(AddonModWorkshopIndexComponent) activityComponent?: AddonModWorkshopIndexComponent;\n\n    selectedGroup = 0;\n\n    /**\n     * @inheritdoc\n     */\n    ngOnInit(): void {\n        super.ngOnInit();\n        this.selectedGroup = CoreNavigator.getRouteNumberParam('group') || 0;\n    }\n\n}\n","// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { CanLeaveGuard } from '@guards/can-leave';\n\nimport { CoreSharedModule } from '@/core/shared.module';\nimport { AddonModWorkshopIndexPage } from './pages/index/index';\nimport { AddonModWorkshopComponentsModule } from './components/components.module';\nimport { AddonModWorkshopSubmissionPage } from './pages/submission/submission';\nimport { CoreEditorComponentsModule } from '@features/editor/components/components.module';\nimport { AddonModWorkshopAssessmentPage } from './pages/assessment/assessment';\nimport { AddonModWorkshopEditSubmissionPage } from './pages/edit-submission/edit-submission';\n\nconst routes: Routes = [\n    {\n        path: ':courseId/:cmId',\n        component: AddonModWorkshopIndexPage,\n    },\n    {\n        path: ':courseId/:cmId/:submissionId',\n        component: AddonModWorkshopSubmissionPage,\n        canDeactivate: [CanLeaveGuard],\n    },\n    {\n        path: ':courseId/:cmId/:submissionId/edit',\n        component: AddonModWorkshopEditSubmissionPage,\n        canDeactivate: [CanLeaveGuard],\n    },\n    {\n        path: ':courseId/:cmId/:submissionId/:assessmentId',\n        component: AddonModWorkshopAssessmentPage,\n        canDeactivate: [CanLeaveGuard],\n    },\n];\n\n@NgModule({\n    imports: [\n        RouterModule.forChild(routes),\n        CoreSharedModule,\n        AddonModWorkshopComponentsModule,\n        CoreEditorComponentsModule,\n    ],\n    declarations: [\n        AddonModWorkshopIndexPage,\n        AddonModWorkshopSubmissionPage,\n        AddonModWorkshopAssessmentPage,\n        AddonModWorkshopEditSubmissionPage,\n    ],\n})\nexport class AddonModWorkshopLazyModule {}\n"],"sourceRoot":"webpack:///"}